import{a as f,f as m,t as wt,c as dr}from"../chunks/D_ansCh4.js";import{o as cr,a as ur}from"../chunks/YuJsNucz.js";import{p as Os,ax as Es,c as i,s as l,y as e,r as a,t as x,a as Ds,av as b,A as t,aE as de,z as vs,aw as fr,f as St,o as Vt,e as pr,$ as gr,aJ as ds,n as kt}from"../chunks/Cl0DMWZv.js";import{d as Fs,e as Ht,a as w,s as p}from"../chunks/Cv63ugJo.js";import{i as h,a as mr}from"../chunks/BTM6jyxq.js";import{e as ps,i as _r}from"../chunks/CXL-JkK8.js";import{h as br}from"../chunks/avLAz_gZ.js";import{s as ot,r as js}from"../chunks/j3NwBB6B.js";import{s as Ee}from"../chunks/D9jd4Gan.js";import{b as Mt}from"../chunks/DQcjtaIM.js";import{b as As}from"../chunks/D-OXtg45.js";import{s as xr,a as hr}from"../chunks/BF7g9if2.js";import{p as yr}from"../chunks/DbvR7NoS.js";import{u as cs}from"../chunks/BnVcnDgT.js";import{k as zr,m as us,s as Ot,l as qs,n as wr,o as Dt,p as Us,q as Sr,r as kr,t as Mr,u as Pr,v as Tr,w as Cr,x as Ir,y as Rr}from"../chunks/CYvOnIj9.js";import{S as Ft}from"../chunks/CsWrsq56.js";import{p as Br}from"../chunks/ChVnncLT.js";import{g as fs}from"../chunks/eE_TcHx0.js";import{g as Er,d as jr,a as Vs,b as Ar}from"../chunks/TOj9C5s8.js";var qr=m('<span class="item-icon svelte-pfyflm"> </span>'),Ur=m('<button><!> <span class="item-label svelte-pfyflm"> </span></button>'),Vr=m('<div class="dropdown-menu svelte-pfyflm"></div>'),Or=m('<div class="kebab-menu-container svelte-pfyflm"><button class="kebab-btn svelte-pfyflm" aria-label="More options"><svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><circle cx="10" cy="4" r="2"></circle><circle cx="10" cy="10" r="2"></circle><circle cx="10" cy="16" r="2"></circle></svg></button> <!></div>');function Dr(Yt,je){Os(je,!0);let z=Br(je,"items",19,()=>[]),me=b(!1);function Lt(W){W.stopPropagation(),t(me,!e(me))}function Nt(W){const _e=W.target;e(me)&&!_e.closest(".kebab-menu-container")&&t(me,!1)}function $t(W){var _e;t(me,!1),(_e=je.onselect)==null||_e.call(je,{action:W})}function Gt(W){W.key==="Escape"&&t(me,!1)}let Ne=de(()=>z().filter(W=>W.show!==!1));var nt=Or();Ht("click",Es,Nt),Ht("keydown",Es,Gt);var ke=i(nt),Pt=l(ke,2);{var Jt=W=>{var _e=Vr();ps(_e,21,()=>e(Ne),_r,(Tt,P)=>{var c=Ur();let C;var ye=i(c);{var lt=fe=>{var be=qr(),Pe=i(be,!0);a(be),x(()=>p(Pe,e(P).icon)),f(fe,be)};h(ye,fe=>{e(P).icon&&fe(lt)})}var ze=l(ye,2),Me=i(ze,!0);a(ze),a(c),x(()=>{C=Ee(c,1,"menu-item svelte-pfyflm",null,C,{danger:e(P).variant==="danger"}),p(Me,e(P).label)}),w("click",c,()=>$t(e(P).action)),f(Tt,c)}),a(_e),f(W,_e)};h(Pt,W=>{e(me)&&W(Jt)})}a(nt),x(()=>ot(ke,"aria-expanded",e(me))),w("click",ke,Lt),f(Yt,nt),Ds()}Fs(["click"]);var Fr=m('<div class="loading svelte-9rszxv">Loading conversations...</div>'),Hr=m('<div class="empty-state svelte-9rszxv"><div class="empty-icon svelte-9rszxv">üì¨</div> <h2 class="svelte-9rszxv">No Messages Yet</h2> <p class="svelte-9rszxv">Your conversations with buyers and sellers will appear here.</p> <a href="/products" class="btn-browse svelte-9rszxv">Browse Products</a></div>'),Yr=m('<span class="tab-badge svelte-9rszxv"> </span>'),Lr=m('<span class="tab-badge svelte-9rszxv"> </span>'),Nr=m('<div class="no-conversations svelte-9rszxv"><p class="svelte-9rszxv">No conversations yet</p></div>'),$r=m('<img class="svelte-9rszxv"/>'),Gr=m('<div class="no-image svelte-9rszxv">üì¶</div>'),Jr=m('<span class="sender-name svelte-9rszxv">Me:</span>'),Kr=m('<span class="sender-name svelte-9rszxv"> </span>'),Wr=m("<!> ",1),Zr=m('<span class="unread-badge svelte-9rszxv"> </span>'),Qr=m('<button><div class="conversation-image svelte-9rszxv"><!></div> <div class="conversation-info svelte-9rszxv"><h3 class="svelte-9rszxv"> </h3> <p class="seller-name svelte-9rszxv"><!></p> <p class="last-message svelte-9rszxv"><!></p> <span class="timestamp svelte-9rszxv"> </span></div> <!></button>'),Xr=m('<a class="party-name svelte-9rszxv"> </a>'),ea=m('<span class="party-name svelte-9rszxv"> </span>'),ta=m('<div class="party-info svelte-9rszxv"><span class="party-label svelte-9rszxv">Buyer:</span> <!></div>'),sa=m('<div class="loading-conversation svelte-9rszxv"><div class="loading-spinner svelte-9rszxv"></div> <span class="svelte-9rszxv">Loading conversation...</span></div>'),ra=m('<div class="loading-older svelte-9rszxv"><div class="loading-spinner svelte-9rszxv"></div> <span class="svelte-9rszxv">Loading older messages...</span></div>'),aa=m('<span class="message-sender svelte-9rszxv"> </span>'),ia=m('<div><div class="message-content svelte-9rszxv"><!> <p class="svelte-9rszxv"> </p> <span class="message-time svelte-9rszxv"> </span></div></div>'),oa=m('<div class="typing-indicator svelte-9rszxv"><div class="typing-dots svelte-9rszxv"><span class="dot svelte-9rszxv"></span> <span class="dot svelte-9rszxv"></span> <span class="dot svelte-9rszxv"></span></div> <span class="typing-text svelte-9rszxv">typing...</span></div>'),na=m("<!> <!> <!>",1),la=m('<div class="error-message svelte-9rszxv"> </div>'),va=m('<span class="rating-value-text svelte-9rszxv"> </span>'),da=m('<div class="inline-comment-row svelte-9rszxv"><input type="text" placeholder="Add a comment (optional)" class="inline-comment-input svelte-9rszxv"/> <button class="inline-submit-btn svelte-9rszxv"> </button></div>'),ca=m('<div class="inline-rating-error svelte-9rszxv"> </div>'),ua=m('<div class="rating-prompt svelte-9rszxv"><div class="rating-prompt-header svelte-9rszxv"><span class="rating-icon svelte-9rszxv">‚≠ê</span> <span class="rating-title svelte-9rszxv">Rate this transaction</span></div> <p class="rating-prompt-text svelte-9rszxv"> </p> <div class="inline-rating-form svelte-9rszxv"><div class="inline-star-selector svelte-9rszxv"><!> <!></div> <!></div> <!></div>'),fa=m('<span class="rating-comment-text svelte-9rszxv"> </span>'),pa=m('<div class="other-party-rating svelte-9rszxv"><span class="other-rating-label svelte-9rszxv"> </span> <!> <span class="rating-score svelte-9rszxv"> </span></div>'),ga=m('<div class="rating-submitted-inline svelte-9rszxv"><div class="rating-submitted-header svelte-9rszxv"><span class="rating-check svelte-9rszxv">‚úì</span> <span class="svelte-9rszxv"> </span></div> <div class="rating-submitted-content svelte-9rszxv"><!> <span class="rating-score svelte-9rszxv"> </span> <!></div> <!></div>'),ma=m('<div class="inline-rating-section svelte-9rszxv"><!></div>'),_a=m('<div class="chat-blocked-message svelte-9rszxv"><div class="blocked-icon svelte-9rszxv">üîí</div> <p class="blocked-text svelte-9rszxv"> </p> <a class="view-product-btn svelte-9rszxv">View Product Page</a></div>'),ba=m('<form class="chat-input-form svelte-9rszxv"><input type="text" placeholder="Type your message..." class="chat-input svelte-9rszxv"/> <button type="submit" class="send-btn svelte-9rszxv"> </button></form>'),xa=m('<div class="chat-header svelte-9rszxv"><button class="back-btn svelte-9rszxv">‚Üê Back</button> <div class="product-summary svelte-9rszxv"><h3 class="svelte-9rszxv"> </h3> <p class="product-price svelte-9rszxv"> <span> </span></p> <div class="transaction-parties svelte-9rszxv"><div class="party-info svelte-9rszxv"><span class="party-label svelte-9rszxv">Seller:</span> <a class="party-name svelte-9rszxv"> </a></div> <!></div></div> <!></div> <div class="chat-messages svelte-9rszxv"><!></div> <!> <!> <!>',1),ha=m('<div class="no-conversation-selected svelte-9rszxv"><p class="svelte-9rszxv">Select a conversation to start messaging</p></div>'),ya=m('<div class="inbox-container svelte-9rszxv"><aside><div class="tabs svelte-9rszxv"><button>My Products <!></button> <button>My Purchases <!></button></div> <!> <!></aside> <main><!></main></div>'),za=m('<div class="rating-error svelte-9rszxv"> </div>'),wa=m('<div class="modal-overlay svelte-9rszxv" role="button" tabindex="0"><div class="modal-content svelte-9rszxv" role="dialog" aria-modal="true"><button class="modal-close svelte-9rszxv">&times;</button> <h2 class="svelte-9rszxv"> </h2> <p class="modal-subtitle svelte-9rszxv"><!></p> <div class="rating-selector svelte-9rszxv"><!> <span class="rating-value-display svelte-9rszxv"> </span></div> <div class="comment-input svelte-9rszxv"><label for="rating-comment" class="svelte-9rszxv">Comment (optional)</label> <textarea id="rating-comment" placeholder="Share your experience..." rows="3" class="svelte-9rszxv"></textarea></div> <!> <div class="modal-actions svelte-9rszxv"><button class="btn-cancel svelte-9rszxv">Cancel</button> <button class="btn-submit svelte-9rszxv"> </button></div></div></div>'),Sa=m('<div class="void-error svelte-9rszxv"> </div>'),ka=m(`<div class="modal-overlay svelte-9rszxv"><div class="modal void-modal svelte-9rszxv"><button class="modal-close svelte-9rszxv">&times;</button> <h2 class="svelte-9rszxv">Request Void</h2> <p class="void-description svelte-9rszxv">You are requesting to void the transaction for <strong class="svelte-9rszxv"> </strong>.
        The other party will need to approve this request.</p> <div class="form-group svelte-9rszxv"><label for="voidReason" class="svelte-9rszxv">Reason for void request <span class="required svelte-9rszxv">*</span></label> <textarea id="voidReason" placeholder="Please explain why you want to void this transaction..." rows="4" class="svelte-9rszxv"></textarea></div> <!> <div class="modal-actions svelte-9rszxv"><button class="btn-cancel svelte-9rszxv">Cancel</button> <button class="btn-submit btn-danger svelte-9rszxv"> </button></div></div></div>`),Ma=m('<div class="void-error svelte-9rszxv"> </div>'),Pa=m('<div class="modal-overlay svelte-9rszxv"><div class="modal void-modal svelte-9rszxv"><button class="modal-close svelte-9rszxv">&times;</button> <h2 class="svelte-9rszxv">Void Request</h2> <p class="void-description svelte-9rszxv"><strong class="svelte-9rszxv"> </strong> has requested to void the transaction for <strong class="svelte-9rszxv"> </strong>.</p> <div class="void-reason-display svelte-9rszxv"><label class="svelte-9rszxv">Their reason:</label> <p class="svelte-9rszxv"> </p></div> <div class="form-group rejection-reason svelte-9rszxv" style="display: none;" id="rejectionReasonGroup"><label for="voidRejectionReason" class="svelte-9rszxv">Reason for rejection <span class="required svelte-9rszxv">*</span></label> <textarea id="voidRejectionReason" placeholder="Please explain why you are rejecting this void request..." rows="3" class="svelte-9rszxv"></textarea></div> <!> <div class="modal-actions three-buttons svelte-9rszxv"><button class="btn-cancel svelte-9rszxv">Cancel</button> <button class="btn-reject svelte-9rszxv"> </button> <button class="btn-submit btn-success svelte-9rszxv"> </button></div></div></div>'),Ta=m('<div class="void-error svelte-9rszxv"> </div>'),Ca=m(`<div class="modal-overlay svelte-9rszxv"><div class="modal void-modal seller-choice-modal svelte-9rszxv"><button class="modal-close svelte-9rszxv">&times;</button> <h2 class="svelte-9rszxv">Transaction Voided</h2> <p class="void-description svelte-9rszxv">The void request for <strong class="svelte-9rszxv"> </strong> has been approved.
        As the seller, please choose what to do next:</p> <div class="choice-options svelte-9rszxv"><button class="choice-option svelte-9rszxv"><div class="choice-icon svelte-9rszxv">üîÑ</div> <div class="choice-content svelte-9rszxv"><h3 class="svelte-9rszxv">Restart Bidding</h3> <p class="svelte-9rszxv">Reopen the auction and let all bidders participate again</p></div></button> <button class="choice-option svelte-9rszxv"><div class="choice-icon svelte-9rszxv">ü•à</div> <div class="choice-content svelte-9rszxv"><h3 class="svelte-9rszxv">Offer to 2nd Highest Bidder</h3> <p class="svelte-9rszxv">Give the second highest bidder a chance to purchase at their bid amount</p></div></button></div> <!></div></div>`),Ia=m('<div class="void-error svelte-9rszxv"> </div>'),Ra=m('<div class="modal-overlay svelte-9rszxv"><div class="modal void-modal svelte-9rszxv"><button class="modal-close svelte-9rszxv">&times;</button> <h2 class="svelte-9rszxv">Purchase Offer</h2> <p class="void-description svelte-9rszxv">You have been offered the chance to purchase <strong class="svelte-9rszxv"> </strong> as the second highest bidder!</p> <div class="offer-details svelte-9rszxv"><div class="offer-amount svelte-9rszxv"><label class="svelte-9rszxv">Your bid amount:</label> <span class="amount svelte-9rszxv"> </span></div> <p class="offer-note svelte-9rszxv">The original winner has voided their purchase. Would you like to buy this item at your bid amount?</p></div> <!> <div class="modal-actions svelte-9rszxv"><button class="btn-cancel svelte-9rszxv"> </button> <button class="btn-submit btn-success svelte-9rszxv"> </button></div></div></div>'),Ba=m('<div class="inbox-page svelte-9rszxv"><h1 class="svelte-9rszxv">Inbox</h1> <!></div> <!> <!> <!> <!> <!>',1);function Qa(Yt,je){Os(je,!0);const z=()=>hr(mr,"$authStore",me),[me,Lt]=xr();function Nt(){t(c,null),fs("/inbox",{replaceState:!0})}function $t(s){if(e(c))switch(s){case"view_product":fs(`/products/${e(c).id}?from=inbox`);break;case"void_bid":Gt();break}}function Gt(){t(De,""),t(I,""),t(Wt,!0)}function Ne(){t(Wt,!1),t(De,""),t(I,"")}async function nt(){if(!e(Z)||!e(De).trim()){t(I,"Please provide a reason for voiding");return}t(L,!0),t(I,"");try{const s=await Pr(e(Z).id,e(De));s.success?(Ne(),alert("Void request submitted successfully. Waiting for the other party to respond.")):t(I,s.error||"Failed to create void request",!0)}catch(s){t(I,s.message||"Failed to create void request",!0)}finally{t(L,!1)}}function ke(){t(gs,!1),t(re,null),t(gt,""),t(I,"")}async function Pt(s){var r,o,n;if(e(re)){if(s==="reject"&&!e(gt).trim()){t(I,"Please provide a reason for rejection");return}t(L,!0),t(I,"");try{const d=await Tr(e(re).id,s,s==="reject"?e(gt):void 0);d.success?(ke(),s==="approve"&&d.requiresSellerChoice?((o=(r=e(c))==null?void 0:r.seller)==null?void 0:o.id)===((n=z().user)==null?void 0:n.id)?t(pt,!0):alert("Void request approved. The seller will decide what to do next."):alert(s==="approve"?"Void request approved":"Void request rejected")):t(I,d.error||"Failed to respond to void request",!0)}catch(d){t(I,d.message||"Failed to respond to void request",!0)}finally{t(L,!1)}}}function Jt(){t(pt,!1),t(I,"")}async function W(s){var o;if(!e(re)&&!Ct)return;const r=((o=e(re))==null?void 0:o.id)||(Ct==null?void 0:Ct.id);t(L,!0),t(I,"");try{const n=await Cr(r,s);n.success?(Jt(),alert(s==="restart_bidding"?`Auction restarted! ${n.notifiedBidders||0} bidders have been notified.`:"Offer sent to the second highest bidder."),window.location.reload()):n.onlyOption==="restart_bidding"?t(I,"No second bidder available. Please restart the bidding instead."):t(I,n.error||"Failed to process choice",!0)}catch(n){t(I,n.message||"Failed to process choice",!0)}finally{t(L,!1)}}function _e(){t(It,!1),t(re,null),t(I,"")}async function Tt(s){if(e(re)){t(L,!0),t(I,"");try{const r=await Ir(e(re).id,s);r.success?(_e(),s==="accept"?(alert("Congratulations! You have secured the item. Check your inbox for next steps."),window.location.reload()):alert("You have declined the offer.")):t(I,r.error||"Failed to respond to offer",!0)}catch(r){t(I,r.message||"Failed to respond to offer",!0)}finally{t(L,!1)}}}let P=b(vs([])),c=b(null),C=b(vs([])),ye=b(""),lt=b(!0),ze=b(!1),Me=b(!1),fe=b(""),be=b(null),Pe=b(null),we=b(null),$e=b(void 0),Te=b(null),Ae=b(null),Ce=b(null),Se=b(!1),Ie=b(!1),qe=b("products"),ee=b(null),Ue=b(!0),vt=b(!1),Ve=b(!0);const Ge=10;let Je=b(!0),dt=b(""),ie=b(vs(new Set)),ct=b(null),ut=b(!1),Kt=b(null),Z=b(null),Re=b(null),ft=b(null),Ke=b(!1),oe=b(0),We=b(""),Ze=b(!1),Qe=b(""),ne=b(null),Oe=b(null),Ct=null,Wt=b(!1),gs=b(!1),pt=b(!1),It=b(!1),De=b(""),gt=b(""),L=b(!1),I=b(""),re=b(null),Rt=de(()=>yr.url.searchParams.get("product")),Zt=de(()=>e(P).filter(s=>{var r,o;return((r=s.product.seller)==null?void 0:r.id)===((o=z().user)==null?void 0:o.id)}).sort((s,r)=>new Date(r.lastMessage.createdAt).getTime()-new Date(s.lastMessage.createdAt).getTime())),Qt=de(()=>e(P).filter(s=>{var r,o;return((r=s.product.seller)==null?void 0:r.id)!==((o=z().user)==null?void 0:o.id)}).sort((s,r)=>new Date(r.lastMessage.createdAt).getTime()-new Date(s.lastMessage.createdAt).getTime())),ms=de(()=>e(qe)==="products"?e(Zt):e(Qt));const Hs={PHP:"‚Ç±",USD:"$",EUR:"‚Ç¨",GBP:"¬£",JPY:"¬•"};function _s(s,r){return`${Hs[r]||r}${s.toLocaleString()}`}function bs(s){const r=new Date(s),n=new Date().getTime()-r.getTime(),d=Math.floor(n/(1e3*60*60));if(d<1){const u=Math.floor(n/6e4);return u===0?"Just now":`${u}m ago`}else return d<24?`${d}h ago`:r.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Xt(s){if(!z().user)return null;const r=typeof s.sender=="object"?s.sender:null,o=typeof s.receiver=="object"?s.receiver:null;return r&&r.id===z().user.id?o:r}function Ys(){return e(ee)?e(ee).scrollHeight-e(ee).scrollTop-e(ee).clientHeight<=100:!0}function Ls(){return e(ee)?e(ee).scrollTop<=50:!1}function Ns(){t(Ue,Ys(),!0),Ls()&&!e(vt)&&e(Ve)&&e(c)&&$s()}async function $s(){var r;if(!e(c)||e(vt)||!e(Ve))return;t(vt,!0);const s=((r=e(ee))==null?void 0:r.scrollHeight)||0;try{const o=e(C)[0];if(!o){t(Ve,!1);return}const n=await Dt(e(c).id,void 0,{limit:Ge,before:o.createdAt});if(n.length<Ge&&t(Ve,!1),n.length>0){if(t(C,[...n,...e(C)],!0),await Vt(),e(ee)){const d=e(ee).scrollHeight;e(ee).scrollTop=d-s}}else t(Ve,!1)}catch(o){console.error("Error loading older messages:",o)}finally{t(vt,!1)}}async function Xe(s=!1){!e(ee)||!e(Ue)&&!s||(await Vt(),e(ee).scrollTop=e(ee).scrollHeight)}async function xs(s){var _;if(!z().user)return{allowed:!1,reason:"You must be logged in to chat."};if(((_=s.seller)==null?void 0:_.id)===z().user.id)return{allowed:!0};if(s.status==="available")return{allowed:!1,reason:"The bidding is still ongoing and you can only chat if you won the bid.",isOngoing:!0};if(s.status!=="sold")return{allowed:!1,reason:"This auction has ended. You can only chat if the seller accepted your bid."};const o=await Us(s.id);if(o.length===0)return{allowed:!1,reason:"No bids were placed on this product."};const d=[...o].sort((g,y)=>y.amount-g.amount)[0];return(typeof d.bidder=="object"?d.bidder.id:d.bidder)!==z().user.id?{allowed:!1,reason:"You did not win this bid."}:{allowed:!0}}async function hs(s){var r,o;if(t(Z,null),t(Re,null),t(ft,null),t(ne,null),t(Oe,null),t(Oe,((r=s.seller)==null?void 0:r.name)||"Unknown Seller",!0),s.status==="sold")try{const n=await Sr(s.id);if(!n)return;t(Z,n,!0),typeof n.buyer=="object"&&n.buyer&&t(ne,n.buyer.name||"Unknown Buyer",!0),t(Re,await kr(n.id),!0);const d=await fetch(`/api/bridge/ratings?where[transaction][equals]=${n.id}&depth=1`,{headers:{"Content-Type":"application/json"},credentials:"include"});if(d.ok){const _=(await d.json()).docs||[],g=(o=z().user)==null?void 0:o.id;t(ft,_.find(y=>(typeof y.rater=="object"?y.rater.id:y.rater)!==g)||null,!0)}}catch(n){console.error("Error loading rating data:",n)}}async function ys(){if(!(!e(Z)||e(oe)===0)){t(Ze,!0),t(Qe,"");try{const s=await Mr(e(Z).id,e(oe),e(We)||void 0);s&&(t(Re,s,!0),t(Ke,!1),t(oe,0),t(We,""))}catch(s){t(Qe,s.message||"Failed to submit rating",!0)}finally{t(Ze,!1)}}}async function zs(s){var r;if(!z().user)return null;if(((r=s.seller)==null?void 0:r.id)===z().user.id){const o=e(C).map(n=>Xt(n)).filter((n,d,u)=>n&&u.findIndex(_=>(_==null?void 0:_.id)===n.id)===d);if(o.length>0&&o[0])return o[0].name||"Unknown Buyer";try{const n=await Us(s.id);if(n.length>0){const u=[...n].sort((_,g)=>g.amount-_.amount)[0];if(typeof u.bidder=="object"&&u.bidder)return u.bidder.name||"Unknown Buyer"}}catch(n){console.error("Error fetching bids:",n)}}return null}async function Gs(){var s,r,o,n,d,u;t(lt,!0);try{if(t(P,await qs(),!0),e(Rt)){const _=e(P).find(g=>g.product.id===e(Rt));if(_){const g=((s=_.product.seller)==null?void 0:s.id)===((r=z().user)==null?void 0:r.id);t(qe,g?"products":"purchases",!0),await Ms(_.product)}else try{const g=await wr(e(Rt));if(g){const y=((o=g.seller)==null?void 0:o.id)===((n=z().user)==null?void 0:n.id);t(qe,y?"products":"purchases",!0),t(c,g,!0),t(Je,!0),t(dt,"");const q=await xs(g);t(Je,q.allowed,!0),t(dt,q.reason||"",!0),t(C,await Dt(g.id,void 0,{limit:Ge,latest:!0}),!0),t(Ve,e(C).length===Ge),e(C).length>0?t(we,e(C)[e(C).length-1].createdAt,!0):t(we,new Date().toISOString(),!0),await hs(g),!e(ne)&&((d=g.seller)==null?void 0:d.id)===((u=z().user)==null?void 0:u.id)&&t(ne,await zs(g),!0),Bt(),ts(e(Rt)),t(Ie,!1),t(Se,!1),t(Ue,!0),await Vt(),setTimeout(()=>Xe(!0),100)}}catch(g){console.error("Error loading product:",g)}}Ss()}catch(_){t(fe,"Failed to load conversations"),console.error("Error loading conversations:",_)}finally{t(lt,!1)}}async function ws(){try{const s=await qs();for(const r of s){const o=e(P).findIndex(n=>n.product.id===r.product.id);if(o!==-1){const n=e(P)[o];(n.lastMessage.id!==r.lastMessage.id||n.unreadCount!==r.unreadCount)&&(e(P)[o]=r)}else t(P,[r,...e(P)],!0)}t(P,e(P).filter(r=>s.some(o=>o.product.id===r.product.id)),!0)}catch(s){console.error("Error polling conversation list:",s)}}function Ss(){e(Pe)&&clearInterval(e(Pe)),t(Pe,setInterval(ws,3e4),!0)}function ks(){e(Pe)&&(clearInterval(e(Pe)),t(Pe,null))}async function Ms(s){var r,o,n;t(ze,!0);try{t(c,s,!0),t(Je,!0),t(dt,"");const d=await xs(s);t(Je,d.allowed,!0),t(dt,d.reason||"",!0),t(C,await Dt(s.id,void 0,{limit:Ge,latest:!0}),!0),t(Ve,e(C).length===Ge),e(C).length>0?t(we,e(C)[e(C).length-1].createdAt,!0):t(we,new Date().toISOString(),!0);let u=0;for(const g of e(C))(typeof g.receiver=="object"?g.receiver.id:g.receiver)===((r=z().user)==null?void 0:r.id)&&!g.read&&(await us(g.id),u++);u>0&&cs.decrement(u);const _=e(P).findIndex(g=>g.product.id===s.id);_!==-1&&e(P)[_].unreadCount>0&&(e(P)[_]={...e(P)[_],unreadCount:0}),await hs(s),!e(ne)&&((o=s.seller)==null?void 0:o.id)===((n=z().user)==null?void 0:n.id)&&t(ne,await zs(s),!0),Bt(),e(c)&&ts(String(e(c).id)),t(Ie,!1),t(Se,!1),t(Ue,!0),setTimeout(()=>{Xe(!0),e($e)&&e($e).focus()},100)}finally{t(ze,!1)}}async function Js(){var s;if(!(!e(c)||!e(we)))try{const r=await Dt(e(c).id,e(we));if(r.length>0){const o=new Set(e(C).map(d=>d.id)),n=r.filter(d=>!o.has(d.id));if(n.length>0){for(const u of n)t(ie,new Set([...e(ie),u.id]),!0);t(C,[...e(C),...n],!0),t(we,n[n.length-1].createdAt,!0);let d=0;for(const u of n)(typeof u.receiver=="object"?u.receiver.id:u.receiver)===((s=z().user)==null?void 0:s.id)&&!u.read&&(await us(u.id),d++);d>0&&cs.decrement(d),setTimeout(()=>{for(const u of n)t(ie,new Set([...e(ie)].filter(_=>_!==u.id)),!0)},500)}Ks(e(c).id,r[r.length-1]),setTimeout(Xe,100)}}catch(r){console.error("Error polling for new messages:",r)}}function Ks(s,r){const o=e(P).findIndex(n=>n.product.id===s);if(o!==-1){e(P)[o]={...e(P)[o],lastMessage:r};const n=e(P)[o];t(P,[n,...e(P).slice(0,o),...e(P).slice(o+1)],!0)}}function Bt(){e(ut)||(e(be)&&clearInterval(e(be)),t(be,setInterval(Js,1e4),!0))}function es(){e(be)&&(clearInterval(e(be)),t(be,null))}function Ws(){e(c)&&(t(Ie,!0),e(Te)&&clearTimeout(e(Te)),Ot(e(c).id,!0),t(Te,setTimeout(()=>{e(c)&&Ot(e(c).id,!1),t(Ie,!1)},2500),!0))}function ts(s){if(e(Ce)&&e(Ce)!==s&&(e(Ae)&&(e(Ae)(),t(Ae,null)),Vs(e(Ce))),e(Ce)===s)return;t(Ce,s,!0);const r=Ar(s);r.connect();let o=null;t(Ae,r.subscribe(n=>{var d;if(n.type==="typing"){const u=n;String(u.userId)!==String((d=z().user)==null?void 0:d.id)&&(o&&(clearTimeout(o),o=null),u.isTyping?(t(Se,!0),o=setTimeout(()=>{t(Se,!1)},4e3)):o=setTimeout(()=>{t(Se,!1)},1500))}}),!0)}function Zs(){e(Ae)&&(e(Ae)(),t(Ae,null)),e(Ce)&&(Vs(e(Ce)),t(Ce,null)),t(Se,!1)}async function Qs(){if(!(!e(ye).trim()||!e(c)||!z().user||!e(Je))){t(Me,!0),t(fe,"");try{let s;if(e(c).seller.id===z().user.id){const o=e(C).map(n=>Xt(n)).filter((n,d,u)=>n&&u.findIndex(_=>(_==null?void 0:_.id)===n.id)===d);if(o.length>0&&o[0])s=o[0].id;else{t(fe,"No buyer to message"),t(Me,!1);return}}else s=e(c).seller.id;const r=await Rr(e(c).id,s,e(ye).trim());r?(t(ie,new Set([...e(ie),r.id]),!0),t(C,[...e(C),r],!0),t(ye,""),t(we,r.createdAt,!0),setTimeout(()=>{t(ie,new Set([...e(ie)].filter(o=>o!==r.id)),!0)},500),e(c)&&Ot(e(c).id,!1),e(Te)&&(clearTimeout(e(Te)),t(Te,null)),t(Ie,!1),t(Ue,!0),setTimeout(Xe,100),setTimeout(()=>{e($e)&&e($e).focus()},50)):t(fe,"Failed to send message")}catch(s){t(fe,"Failed to send message"),console.error("Error sending message:",s)}finally{t(Me,!1)}}}cr(()=>{let s;return(async()=>{var o;if(!z().isAuthenticated){fs("/login?redirect=/inbox");return}if(await Gs(),(o=z().user)!=null&&o.id){const n=Er(String(z().user.id));n.connect(),t(Kt,n.state.subscribe(u=>{const _=e(ut);t(ut,u==="connected"),e(ut)&&!_?es():!e(ut)&&_&&e(c)&&Bt()}),!0);const d=n.subscribe(async u=>{var _;if(u.type==="new_message"){const g=u;if(e(c)&&String(g.productId)===String(e(c).id)){let y=null;g.message?y=g.message:y=await zr(g.messageId),y&&(e(C).some(G=>G.id===y.id)||(t(ie,new Set([...e(ie),y.id]),!0),t(C,[...e(C),y],!0),t(we,y.createdAt,!0),(typeof y.receiver=="object"?y.receiver.id:y.receiver)===((_=z().user)==null?void 0:_.id)&&!y.read&&(us(y.id),cs.decrement(1)),t(Ue,!0),await Vt(),Xe(!0),setTimeout(()=>{t(ie,new Set([...e(ie)].filter(Q=>Q!==y.id)),!0)},500)))}e(ct)&&clearTimeout(e(ct)),t(ct,setTimeout(()=>{ws()},500),!0)}});window.__sseUnsubscribe=d}const r=()=>{document.hidden?(es(),ks()):(e(c)&&(Bt(),ts(String(e(c).id))),Ss())};document.addEventListener("visibilitychange",r),s=()=>{document.removeEventListener("visibilitychange",r)}})(),()=>{s==null||s()}}),fr(()=>{e(Se)&&!e(Ie)&&e(Ue)&&setTimeout(Xe,50)}),ur(()=>{var s;es(),ks(),Zs(),e(Te)&&clearTimeout(e(Te)),e(ct)&&clearTimeout(e(ct)),e(c)&&Ot(e(c).id,!1),t(Ie,!1),t(Se,!1),e(Kt)&&e(Kt)(),(s=z().user)!=null&&s.id&&jr(String(z().user.id)),window.__sseUnsubscribe&&window.__sseUnsubscribe()});var Ps=Ba();br("9rszxv",s=>{pr(()=>{gr.title="Inbox - BidMo.to"})});var ss=St(Ps),Xs=l(i(ss),2);{var er=s=>{var r=Fr();f(s,r)},tr=s=>{var r=Hr();f(s,r)},sr=s=>{var r=ya(),o=i(r);let n;var d=i(o),u=i(d);let _;var g=l(i(u));{var y=E=>{var v=Yr(),j=i(v,!0);a(v),x(()=>p(j,e(Zt).length)),f(E,v)};h(g,E=>{e(Zt).length>0&&E(y)})}a(u);var q=l(u,2);let G;var Q=l(i(q));{var U=E=>{var v=Lr(),j=i(v,!0);a(v),x(()=>p(j,e(Qt).length)),f(E,v)};h(Q,E=>{e(Qt).length>0&&E(U)})}a(q),a(d);var $=l(d,2);{var J=E=>{var v=Nr();f(E,v)};h($,E=>{e(ms).length===0&&E(J)})}var K=l($,2);ps(K,17,()=>e(ms),E=>E.product.id,(E,v)=>{const j=de(()=>{var M,B;return((M=e(v).product.seller)==null?void 0:M.id)===((B=z().user)==null?void 0:B.id)}),ge=de(()=>Xt(e(v).lastMessage));var xe=Qr();let et;var mt=i(xe),_t=i(mt);{var Et=M=>{var B=$r();x(()=>{ot(B,"src",e(v).product.images[0].image.url),ot(B,"alt",e(v).product.title)}),f(M,B)},bt=M=>{var B=Gr();f(M,B)};h(_t,M=>{e(v).product.images&&e(v).product.images.length>0&&e(v).product.images[0].image?M(Et):M(bt,!1)})}a(mt);var xt=l(mt,2),tt=i(xt),ht=i(tt,!0);a(tt);var Fe=l(tt,2),rs=i(Fe);{var as=M=>{var B=wt();x(()=>{var ae;return p(B,`Buyer: ${(((ae=e(ge))==null?void 0:ae.name)||"Unknown")??""}`)}),f(M,B)},is=M=>{var B=wt();x(()=>{var ae;return p(B,`Seller: ${(((ae=e(v).product.seller)==null?void 0:ae.name)||"Unknown")??""}`)}),f(M,B)};h(rs,M=>{e(j)?M(as):M(is,!1)})}a(Fe);var yt=l(Fe,2),He=i(yt);{var os=M=>{const B=de(()=>typeof e(v).lastMessage.sender=="object"?e(v).lastMessage.sender.id:e(v).lastMessage.sender),ae=de(()=>{var V;return((V=z().user)==null?void 0:V.id)===e(B)});var Ut=Wr(),S=St(Ut);{var k=V=>{var R=Jr();f(V,R)},H=V=>{var R=dr(),N=St(R);{var A=Y=>{var ce=Kr(),ue=i(ce);a(ce),x(()=>p(ue,`${e(ge).name??""}:`)),f(Y,ce)};h(N,Y=>{e(ge)&&Y(A)})}f(V,R)};h(S,V=>{e(ae)?V(k):V(H,!1)})}var ve=l(S);x(V=>p(ve,` ${V??""}${e(v).lastMessage.message.length>50?"...":""}`),[()=>e(v).lastMessage.message.substring(0,50)]),f(M,Ut)},ns=M=>{var B=wt("No messages yet");f(M,B)};h(He,M=>{e(v).lastMessage?M(os):M(ns,!1)})}a(yt);var jt=l(yt,2),At=i(jt,!0);a(jt),a(xt);var ls=l(xt,2);{var qt=M=>{var B=Zr(),ae=i(B,!0);a(B),x(()=>p(ae,e(v).unreadCount)),f(M,B)};h(ls,M=>{e(v).unreadCount>0&&M(qt)})}a(xe),x(M=>{var B,ae;et=Ee(xe,1,"conversation-item svelte-9rszxv",null,et,{active:((B=e(c))==null?void 0:B.id)===e(v).product.id,loading:e(ze)&&((ae=e(c))==null?void 0:ae.id)===e(v).product.id}),xe.disabled=e(ze),p(ht,e(v).product.title),p(At,M)},[()=>bs(e(v).lastMessage.createdAt)]),w("click",xe,()=>Ms(e(v).product)),f(E,xe)}),a(o);var D=l(o,2);let pe;var F=i(D);{var X=E=>{var v=xa(),j=St(v),ge=i(j),xe=l(ge,2),et=i(xe),mt=i(et,!0);a(et);var _t=l(et,2),Et=i(_t),bt=l(Et),xt=i(bt,!0);a(bt),a(_t);var tt=l(_t,2),ht=i(tt),Fe=l(i(ht),2),rs=i(Fe,!0);a(Fe),a(ht);var as=l(ht,2);{var is=S=>{var k=ta(),H=l(i(k),2);{var ve=R=>{var N=Xr(),A=i(N,!0);a(N),x(()=>{ot(N,"href",`/users/${e(Z).buyer.id??""}`),p(A,e(ne)||"Unknown")}),f(R,N)},V=R=>{var N=ea(),A=i(N,!0);a(N),x(()=>p(A,e(ne)||"Unknown")),f(R,N)};h(H,R=>{e(Z)&&typeof e(Z).buyer=="object"&&e(Z).buyer?R(ve):R(V,!1)})}a(k),f(S,k)};h(as,S=>{(e(ne)||e(c).status==="sold"&&e(Z))&&S(is)})}a(tt),a(xe);var yt=l(xe,2);{let S=de(()=>[{label:"View Product",action:"view_product",show:!0,icon:"üîó"},{label:"Void Bid",action:"void_bid",show:e(c).status==="sold"&&!!e(Z)&&(e(Z).status==="pending"||e(Z).status==="in_progress"),variant:"danger",icon:"‚ùå"}]);Dr(yt,{get items(){return e(S)},onselect:k=>$t(k.action)})}a(j);var He=l(j,2),os=i(He);{var ns=S=>{var k=sa();f(S,k)},jt=S=>{var k=na(),H=St(k);{var ve=A=>{var Y=ra();f(A,Y)};h(H,A=>{e(vt)&&A(ve)})}var V=l(H,2);ps(V,17,()=>e(C),A=>A.id,(A,Y)=>{const ce=de(()=>{var se;return((se=z().user)==null?void 0:se.id)===(typeof e(Y).sender=="object"?e(Y).sender.id:e(Y).sender)}),ue=de(()=>typeof e(Y).sender=="object"?e(Y).sender:null),Ye=de(()=>e(ie).has(e(Y).id));var he=ia();let st;var rt=i(he),at=i(rt);{var zt=se=>{var Be=aa(),it=i(Be,!0);a(Be),x(()=>p(it,e(ue).name)),f(se,Be)};h(at,se=>{!e(ce)&&e(ue)&&se(zt)})}var Le=l(at,2),T=i(Le,!0);a(Le);var O=l(Le,2),te=i(O,!0);a(O),a(rt),a(he),x(se=>{st=Ee(he,1,"message svelte-9rszxv",null,st,{mine:e(ce),"new-message":e(Ye)}),p(T,e(Y).message),p(te,se)},[()=>bs(e(Y).createdAt)]),f(A,he)});var R=l(V,2);{var N=A=>{var Y=oa();f(A,Y)};h(R,A=>{e(Se)&&!e(Ie)&&A(N)})}f(S,k)};h(os,S=>{e(ze)?S(ns):S(jt,!1)})}a(He),As(He,S=>t(ee,S),()=>e(ee));var At=l(He,2);{var ls=S=>{var k=la(),H=i(k,!0);a(k),x(()=>p(H,e(fe))),f(S,k)};h(At,S=>{e(fe)&&S(ls)})}var qt=l(At,2);{var M=S=>{var k=ma(),H=i(k);{var ve=R=>{var N=ua(),A=l(i(N),2),Y=i(A);a(A);var ce=l(A,2),ue=i(ce),Ye=i(ue);Ft(Ye,{get rating(){return e(oe)},interactive:!0,size:"medium",onchange:T=>t(oe,T.rating,!0)});var he=l(Ye,2);{var st=T=>{var O=va(),te=i(O);a(O),x(()=>p(te,`${e(oe)??""}/5`)),f(T,O)};h(he,T=>{e(oe)>0&&T(st)})}a(ue);var rt=l(ue,2);{var at=T=>{var O=da(),te=i(O);js(te);var se=l(te,2),Be=i(se,!0);a(se),a(O),x(()=>{se.disabled=e(Ze),p(Be,e(Ze)?"...":"Submit")}),Mt(te,()=>e(We),it=>t(We,it)),w("click",se,ys),f(T,O)};h(rt,T=>{e(oe)>0&&T(at)})}a(ce);var zt=l(ce,2);{var Le=T=>{var O=ca(),te=i(O,!0);a(O),x(()=>p(te,e(Qe))),f(T,O)};h(zt,T=>{e(Qe)&&T(Le)})}a(N),x(()=>{var T;return p(Y,`How was your experience with ${(((T=z().user)==null?void 0:T.id)===e(c).seller.id?e(ne)||"the buyer":e(Oe)||"the seller")??""} for this order?`)}),f(R,N)},V=R=>{var N=ga(),A=i(N),Y=l(i(A),2),ce=i(Y);a(Y),a(A);var ue=l(A,2),Ye=i(ue);Ft(Ye,{get rating(){return e(Re).rating},size:"small"});var he=l(Ye,2),st=i(he);a(he);var rt=l(he,2);{var at=T=>{var O=fa(),te=i(O);a(O),x(()=>p(te,`"${e(Re).comment??""}"`)),f(T,O)};h(rt,T=>{e(Re).comment&&T(at)})}a(ue);var zt=l(ue,2);{var Le=T=>{var O=pa(),te=i(O),se=i(te);a(te);var Be=l(te,2);Ft(Be,{get rating(){return e(ft).rating},size:"small"});var it=l(Be,2),vr=i(it);a(it),a(O),x(()=>{var Bs;p(se,`${(((Bs=z().user)==null?void 0:Bs.id)===e(c).seller.id?e(ne)||"Buyer":e(Oe)||"Seller")??""} rated you:`),p(vr,`${e(ft).rating??""}/5`)}),f(T,O)};h(zt,T=>{e(ft)&&T(Le)})}a(N),x(()=>{var T;p(ce,`You rated ${(((T=z().user)==null?void 0:T.id)===e(c).seller.id?e(ne)||"the buyer":e(Oe)||"the seller")??""}`),p(st,`${e(Re).rating??""}/5`)}),f(R,N)};h(H,R=>{e(Re)?R(V,!1):R(ve)})}a(k),f(S,k)};h(qt,S=>{e(c).status==="sold"&&e(Z)&&S(M)})}var B=l(qt,2);{var ae=S=>{var k=_a(),H=l(i(k),2),ve=i(H,!0);a(H);var V=l(H,2);a(k),x(()=>{p(ve,e(dt)),ot(V,"href",`/products/${e(c).id??""}?from=inbox`)}),f(S,k)},Ut=S=>{var k=ba(),H=i(k);js(H),As(H,R=>t($e,R),()=>e($e));var ve=l(H,2),V=i(ve,!0);a(ve),a(k),x(R=>{H.disabled=e(Me),ve.disabled=R,p(V,e(Me)?"Sending...":"Send")},[()=>e(Me)||!e(ye).trim()]),Ht("submit",k,R=>{R.preventDefault(),Qs()}),w("input",H,Ws),Mt(H,()=>e(ye),R=>t(ye,R)),f(S,k)};h(B,S=>{e(Je)?S(Ut,!1):S(ae)})}x(S=>{var k;ge.disabled=e(ze),p(mt,e(c).title),p(Et,`${S??""}
                ‚Ä¢ `),Ee(bt,1,`status-badge status-${e(c).status??""}`,"svelte-9rszxv"),p(xt,e(c).status),ot(Fe,"href",`/users/${e(c).seller.id??""}`),p(rs,e(Oe)||((k=e(c).seller)==null?void 0:k.name)||"Unknown")},[()=>_s(e(c).currentBid||e(c).startingPrice,e(c).seller.currency)]),w("click",ge,Nt),Ht("scroll",He,Ns),f(E,v)},le=E=>{var v=ha();f(E,v)};h(F,E=>{e(c)?E(X):E(le,!1)})}a(D),a(r),x(()=>{n=Ee(o,1,"conversations-list svelte-9rszxv",null,n,{"hide-on-mobile":e(c)}),_=Ee(u,1,"tab svelte-9rszxv",null,_,{active:e(qe)==="products"}),G=Ee(q,1,"tab svelte-9rszxv",null,G,{active:e(qe)==="purchases"}),pe=Ee(D,1,"chat-area svelte-9rszxv",null,pe,{"show-on-mobile":e(c)})}),w("click",u,()=>t(qe,"products")),w("click",q,()=>t(qe,"purchases")),f(s,r)};h(Xs,s=>{e(lt)?s(er):e(P).length===0?s(tr,1):s(sr,!1)})}a(ss);var Ts=l(ss,2);{var rr=s=>{var r=wa(),o=i(r),n=i(o),d=l(n,2),u=i(d);a(d);var _=l(d,2),g=i(_);{var y=v=>{var j=wt();x(()=>p(j,`How was your experience with ${(e(ne)||"the buyer")??""}?`)),f(v,j)},q=v=>{var j=wt();x(()=>p(j,`How was your experience with ${(e(Oe)||"the seller")??""}?`)),f(v,j)};h(g,v=>{var j;((j=z().user)==null?void 0:j.id)===e(c).seller.id?v(y):v(q,!1)})}a(_);var G=l(_,2),Q=i(G);Ft(Q,{get rating(){return e(oe)},interactive:!0,size:"large",onchange:v=>t(oe,v.rating,!0)});var U=l(Q,2),$=i(U,!0);a(U),a(G);var J=l(G,2),K=l(i(J),2);ds(K),a(J);var D=l(J,2);{var pe=v=>{var j=za(),ge=i(j,!0);a(j),x(()=>p(ge,e(Qe))),f(v,j)};h(D,v=>{e(Qe)&&v(pe)})}var F=l(D,2),X=i(F),le=l(X,2),E=i(le,!0);a(le),a(F),a(o),a(r),x(()=>{var v;p(u,`Rate Your ${((v=z().user)==null?void 0:v.id)===e(c).seller.id?"Buyer":"Seller"}`),p($,e(oe)>0?`${e(oe)}/5`:"Select rating"),le.disabled=e(Ze)||e(oe)===0,p(E,e(Ze)?"Submitting...":"Submit Rating")}),w("click",r,()=>t(Ke,!1)),w("keydown",r,v=>v.key==="Escape"&&t(Ke,!1)),w("click",o,v=>v.stopPropagation()),w("keydown",o,v=>v.stopPropagation()),w("click",n,()=>t(Ke,!1)),Mt(K,()=>e(We),v=>t(We,v)),w("click",X,()=>t(Ke,!1)),w("click",le,ys),f(s,r)};h(Ts,s=>{e(Ke)&&e(c)&&e(Z)&&s(rr)})}var Cs=l(Ts,2);{var ar=s=>{var r=ka(),o=i(r),n=i(o),d=l(n,4),u=l(i(d)),_=i(u,!0);a(u),kt(),a(d);var g=l(d,2),y=l(i(g),2);ds(y),a(g);var q=l(g,2);{var G=K=>{var D=Sa(),pe=i(D,!0);a(D),x(()=>p(pe,e(I))),f(K,D)};h(q,K=>{e(I)&&K(G)})}var Q=l(q,2),U=i(Q),$=l(U,2),J=i($,!0);a($),a(Q),a(o),a(r),x(K=>{var D;p(_,(D=e(c))==null?void 0:D.title),$.disabled=K,p(J,e(L)?"Submitting...":"Submit Void Request")},[()=>e(L)||!e(De).trim()]),w("click",r,Ne),w("click",o,K=>K.stopPropagation()),w("click",n,Ne),Mt(y,()=>e(De),K=>t(De,K)),w("click",U,Ne),w("click",$,nt),f(s,r)};h(Cs,s=>{e(Wt)&&s(ar)})}var Is=l(Cs,2);{var ir=s=>{var r=Pa(),o=i(r),n=i(o),d=l(n,4),u=i(d),_=i(u,!0);a(u);var g=l(u,2),y=i(g,!0);a(g),kt(),a(d);var q=l(d,2),G=l(i(q),2),Q=i(G,!0);a(G),a(q);var U=l(q,2),$=l(i(U),2);ds($),a(U);var J=l(U,2);{var K=v=>{var j=Ma(),ge=i(j,!0);a(j),x(()=>p(ge,e(I))),f(v,j)};h(J,v=>{e(I)&&v(K)})}var D=l(J,2),pe=i(D),F=l(pe,2),X=i(F,!0);a(F);var le=l(F,2),E=i(le,!0);a(le),a(D),a(o),a(r),x(()=>{var v;p(_,typeof e(re).initiator=="object"?e(re).initiator.name:"User"),p(y,(v=e(c))==null?void 0:v.title),p(Q,e(re).reason),F.disabled=e(L),p(X,e(L)?"Processing...":"Reject"),le.disabled=e(L),p(E,e(L)?"Processing...":"Approve Void")}),w("click",r,ke),w("click",o,v=>v.stopPropagation()),w("click",n,ke),Mt($,()=>e(gt),v=>t(gt,v)),w("click",pe,ke),w("click",F,()=>{const v=document.getElementById("rejectionReasonGroup");v&&v.style.display==="none"?v.style.display="block":Pt("reject")}),w("click",le,()=>Pt("approve")),f(s,r)};h(Is,s=>{e(gs)&&e(re)&&s(ir)})}var Rs=l(Is,2);{var or=s=>{var r=Ca(),o=i(r),n=i(o),d=l(n,4),u=l(i(d)),_=i(u,!0);a(u),kt(),a(d);var g=l(d,2),y=i(g),q=l(y,2);a(g);var G=l(g,2);{var Q=U=>{var $=Ta(),J=i($,!0);a($),x(()=>p(J,e(I))),f(U,$)};h(G,U=>{e(I)&&U(Q)})}a(o),a(r),x(()=>{var U;p(_,(U=e(c))==null?void 0:U.title),y.disabled=e(L),q.disabled=e(L)}),w("click",r,()=>t(pt,!1)),w("click",o,U=>U.stopPropagation()),w("click",n,()=>t(pt,!1)),w("click",y,()=>W("restart_bidding")),w("click",q,()=>W("offer_second_bidder")),f(s,r)};h(Rs,s=>{e(pt)&&s(or)})}var nr=l(Rs,2);{var lr=s=>{var r=Ra(),o=i(r),n=i(o),d=l(n,4),u=l(i(d)),_=i(u,!0);a(u),kt(),a(d);var g=l(d,2),y=i(g),q=l(i(y),2),G=i(q,!0);a(q),a(y),kt(2),a(g);var Q=l(g,2);{var U=F=>{var X=Ia(),le=i(X,!0);a(X),x(()=>p(le,e(I))),f(F,X)};h(Q,F=>{e(I)&&F(U)})}var $=l(Q,2),J=i($),K=i(J,!0);a(J);var D=l(J,2),pe=i(D,!0);a(D),a($),a(o),a(r),x(F=>{var X;p(_,(X=e(c))==null?void 0:X.title),p(G,F),J.disabled=e(L),p(K,e(L)?"Processing...":"Decline"),D.disabled=e(L),p(pe,e(L)?"Processing...":"Accept Offer")},[()=>{var F,X;return _s(e(re).secondBidderOffer.offerAmount,((X=(F=e(c))==null?void 0:F.seller)==null?void 0:X.currency)||"PHP")}]),w("click",r,()=>t(It,!1)),w("click",o,F=>F.stopPropagation()),w("click",n,()=>t(It,!1)),w("click",J,()=>Tt("decline")),w("click",D,()=>Tt("accept")),f(s,r)};h(nr,s=>{var r;e(It)&&((r=e(re))!=null&&r.secondBidderOffer)&&s(lr)})}f(Yt,Ps),Ds(),Lt()}Fs(["click","input","keydown"]);export{Qa as component};
