import{a as A,f as T}from"../chunks/D_ansCh4.js";import{p as J,t as I,y as t,a as N,e as U,s as a,av as p,c as s,$ as W,r,A as n}from"../chunks/Cl0DMWZv.js";import{e as B,s as L}from"../chunks/Cv63ugJo.js";import{i as M,a as F}from"../chunks/BTM6jyxq.js";import{h as G}from"../chunks/avLAz_gZ.js";import{s as H,r as P}from"../chunks/j3NwBB6B.js";import{b as $}from"../chunks/DQcjtaIM.js";import{g as K}from"../chunks/eE_TcHx0.js";import{p as Q}from"../chunks/DbvR7NoS.js";import{T as V}from"../chunks/Cf8ZiYuD.js";var X=T('<div class="error-message svelte-1x05zx6"> </div>'),Y=T(`<div class="login-page svelte-1x05zx6" style="position: relative; overflow: hidden;"><!> <div class="login-container svelte-1x05zx6" style="position: relative; z-index: 1;"><h1 class="svelte-1x05zx6">Login</h1> <p class="subtitle svelte-1x05zx6">Access your marketplace account</p> <!> <form><div class="form-group svelte-1x05zx6"><label for="email" class="svelte-1x05zx6">Email Address</label> <input id="email" type="email" placeholder="your@email.com" required="" class="svelte-1x05zx6"/></div> <div class="form-group svelte-1x05zx6"><label for="password" class="svelte-1x05zx6">Password</label> <input id="password" type="password" placeholder="Enter your password" required="" class="svelte-1x05zx6"/></div> <button type="submit" class="svelte-1x05zx6"> </button></form> <div class="additional-info svelte-1x05zx6"><p>Don't have an account? <a class="svelte-1x05zx6">Register here</a></p></div></div></div>`);function de(E,O){J(O,!0);let c=p(""),m=p(""),l=p(!1),d=p("");function R(e){return e&&e.startsWith("/")&&!e.startsWith("//")?e:"/"}const _=R(Q.url.searchParams.get("redirect"));async function j(e){e.preventDefault(),n(d,""),n(l,!0);try{const o=await fetch("/api/bridge/users/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t(c),password:t(m)})});if(!o.ok)throw new Error("Invalid email or password");const i=await o.json();i.token&&localStorage.setItem("auth_token",i.token),i.user&&localStorage.setItem("user_data",JSON.stringify(i.user)),F.set({isAuthenticated:!0,user:i.user,token:i.token}),K(_)}catch(o){n(d,o.message||"Invalid email or password. Please try again.",!0)}finally{n(l,!1)}}var u=Y();G("1x05zx6",e=>{U(()=>{W.title="Login - Marketplace Platform"})});var y=s(u);V(y,{});var z=a(y,2),w=a(s(z),4);{var q=e=>{var o=X(),i=s(o,!0);r(o),I(()=>L(i,t(d))),A(e,o)};M(w,e=>{t(d)&&e(q)})}var v=a(w,2),f=s(v),x=a(s(f),2);P(x),r(f);var g=a(f,2),h=a(s(g),2);P(h),r(g);var b=a(g,2),C=s(b,!0);r(b),r(v);var k=a(v,2),S=s(k),D=a(s(S));r(S),r(k),r(z),r(u),I(e=>{x.disabled=t(l),h.disabled=t(l),b.disabled=t(l),L(C,t(l)?"Logging in...":"Login"),H(D,"href",`/register?redirect=${e??""}`)},[()=>encodeURIComponent(_)]),B("submit",v,j),$(x,()=>t(c),e=>n(c,e)),$(h,()=>t(m),e=>n(m,e)),A(E,u),N()}export{de as component};
